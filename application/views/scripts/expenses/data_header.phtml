<?php
global $st_lang;
$last_month = ($this->month == 1) ? 12 : $this->month-1;
$last_year = ($this->month == 1) ? $this->year-1 : $this->year;
$next_month = ($this->month == 12) ? 1 : $this->month+1;
$next_year = ($this->month == 12) ? $this->year+1 : $this->year;
$current_month_and_year = date("M Y", strtotime("01-".$this->month."-".$this->year));
$last_url = "/expenses/index/month/".$last_month."/year/".$last_year;
$next_url = "/expenses/index/month/".$next_month."/year/".$next_year;
?>
<script type="text/javascript" language="text/javascript">
	var deleteUrl = "<?php echo Zend_Registry::get('config')->moxie->settings->url; ?>/expenses/delete/id/";
    var deleteMessage = "<?php echo $st_lang['expenses_delete_message']; ?>";
	var tagList = [<?php if(!empty($this->tags)) echo "'".implode($this->tags, "','")."'"; ?>];
    var usedTagList = [<?php if(!empty($this->used_tag_list)) echo "'".implode($this->used_tag_list, "','")."'"; ?>];
	var tagsPlaceholder = "<?php echo $st_lang['tags_placeholder']; ?>";
</script>
<script type="text/javascript" src="/js/expenses/data.js"></script>

<?php $this->getHelper('Web')->printHeaderNextLastInterval($last_url, $next_url, $current_month_and_year); ?>

<br>

<div id="form">
<div class="moxie_expenses_form_div moxie_expenses_form_left">
<?php
echo '<h2>'.$st_lang['expenses_header'].'</h2>';
$i_expensePK = $this->form->getValue('id');
$checked = ($this->form->getValue('in_sum') == "1") ? "checked": "";
?>
<form id="login" enctype="application/x-www-form-urlencoded" action="<?php echo $this->form->getAction(); ?>" method="<?php echo $this->form->getMethod(); ?>" class="moxie_form">
<?php
if (isset($i_expensePK)) {
?>
	<input type="hidden" id="id" name="id" value="<?php echo $i_expensePK; ?>"/>
<?php
}
//echo $this->form->getElement('id');
echo $this->form->getElement('amount');
echo $this->form->getElement('note');
echo $this->form->getElement('date');
echo $this->form->getElement('category');
?>

<dt for="form_tags">Tags</dt>
<dd id="form_tags" class="dd_taggle_list">
	<div id="tags" class="div_taggle_list"></div>
</dd>
<?php
echo $this->form->getElement('in_sum');
echo $this->form->getElement('favourite');
echo $this->form->getElement('submit');
if(isset($i_expensePK)) {
	echo '<input type="button" class="moxiedelete" value="'.$st_lang['expenses_delete'].'" onclick=\'confirmDelete("' . $i_expensePK . '")\'/>';
}
?>
</form>
</div>
<div id="search_box" class="moxie_expenses_form_div moxie_expenses_form_right">
<?php
echo $this->partial('common/filter.phtml', array('search_form' => $this->search_form));
?>
</div>
</div>
